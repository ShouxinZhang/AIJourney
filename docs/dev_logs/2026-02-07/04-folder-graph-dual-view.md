## 用户 Prompt

> 关于目前
> 对对，其实我感觉，最好是可以弄成一个文件夹系统的样子，对
> 但是呢，可以有一个graph版本的依赖图，对
> 我觉得这样是比较好的，对
>
> 对对

**修改时间**: 2026-02-07 11:57:39

## 概述

将知识图谱升级为“文件夹视图 + 依赖图视图”双模式，既支持业务内容按目录管理，也支持依赖关系可视化分析，提升知识维护与影响评估效率。

## 修改文件清单

| 文件 | 操作 | 修改时间 | 说明 |
|------|------|----------|------|
| `web/src/components/KnowledgeGraph.tsx` | 修改 | 2026-02-07 11:54:48 | 重构为三栏双视图：左侧文件夹导航、中间视图切换、右侧业务详情联动 |
| `docs/architecture/repository-structure.md` | 修改 | 2026-02-07 11:56:16 | 同步组件职责描述，并补充当日开发日志文件结构 |
| `docs/dev_logs/2026-02-07/04-folder-graph-dual-view.md` | 新增 | 2026-02-07 11:57:39 | 记录本次开发变更、验证结果与用户原始需求 |

## 具体变更描述

### 方案

1. 在 `KnowledgeGraph` 中新增视图模式切换：`文件夹视图` 与 `依赖图视图`。
2. 使用同一份 `knowledgeTree` 数据源构建：
   - 左侧文件夹树（可展开/收起）
   - 中间依赖图（React Flow）
   - 右侧业务详情（上游路径、直接依赖、下游规模）
3. 建立统一节点状态：
   - `selectedNodeId` 管理当前业务焦点
   - `expanded` 同时驱动文件夹与依赖图展开状态
4. 修复原组件中的状态同步方式，改为 `useEffect` 同步图节点与边，避免副作用写在 `useMemo`。

### 影响范围

- 受影响模块：前端知识图谱主组件 `KnowledgeGraph`
- 用户可见收益：
  - 管理视角：可用文件夹方式快速定位知识点
  - 分析视角：可切换依赖图查看结构与影响
  - 决策视角：统一详情面板直接展示上下游关系与规模

## 验证结果

- ✔ `bash scripts/check_errors.sh` 通过（依赖检查 / TypeScript / ESLint / Vite build 全部通过）
- ✔ `cd web && npm run test` 通过（6/6）
- ✔ `cd web && timeout 20s npm run dev -- --host 127.0.0.1 --port 4173` 启动成功（Vite ready，超时退出为预期）
